<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Products - Shop</title>
    <link rel="stylesheet" href="../shared/shared.css" />
    <style>
      .filters-section {
        background: var(--white);
        border-radius: var(--radius-lg);
        padding: 24px;
        margin-bottom: 32px;
        box-shadow: var(--shadow);
      }

      .filters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
      }

      .products-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
      }

      .product-count {
        color: var(--muted);
      }

      .product-card-wrap {
        position: relative;
        overflow: hidden;
      }

      .product-card-wrap img {
        width: 100%;
        height: 200px;
        object-fit: cover;
      }

      .out-of-stock-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 1.2rem;
      }

      .wishlist-btn {
        position: absolute;
        top: 12px;
        right: 12px;
        background: var(--white);
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2rem;
        box-shadow: var(--shadow);
        transition: var(--transition);
      }

      .wishlist-btn:hover {
        transform: scale(1.1);
      }

      .wishlist-btn.active {
        background: var(--danger);
        color: var(--white);
      }

      .cart-icon {
        position: fixed;
        bottom: 24px;
        right: 24px;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--primary-dark) 100%
        );
        color: var(--white);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: var(--shadow-lg);
        cursor: pointer;
        transition: var(--transition);
        z-index: 50;
      }

      .cart-icon:hover {
        transform: scale(1.1);
      }

      .cart-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--danger);
        color: white;
        font-size: 0.75rem;
        font-weight: 700;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="nav">
      <div class="nav-brand">
        <i class="fa-solid fa-cart-shopping"></i> E-Commerce
      </div>
      <div class="nav-links">
        <a href="../index.html" class="nav-link">Home</a>
        <a href="products.html" class="nav-link active">Products</a>
        <a href="cart.html" class="nav-link"
          ><i class="fa-solid fa-cart-shopping"></i> Cart
          <span
            id="navCartCount"
            class="badge badge-info"
            style="padding: 2px 6px; font-size: 0.7rem; display: none"
            >0</span
          ></a
        >
        <a
          href="orders.html"
          class="nav-link auth-required"
          style="display: none"
          >My Orders</a
        >
        <a
          href="returns.html"
          class="nav-link auth-required"
          style="display: none"
          >Returns</a
        >
        <a href="../auth/login-register.html" class="nav-link" id="loginLink"
          >Login</a
        >
        <a href="#" class="nav-link logout" id="logoutBtn" style="display: none"
          >Logout</a
        >
      </div>
    </nav>

    <main class="container">
      <div class="page-header">
        <h1 class="page-title">Our Products</h1>
        <p class="page-subtitle">Discover amazing products at great prices.</p>
      </div>

      <!-- Filters -->
      <section class="filters-section">
        <div class="filters-grid">
          <div class="form-group" style="margin-bottom: 0">
            <label class="form-label">Category</label>
            <select class="form-control" id="categoryFilter">
              <option value="">All categories</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom: 0">
            <label class="form-label">Min Price</label>
            <input
              type="number"
              class="form-control"
              id="minPrice"
              placeholder="0"
            />
          </div>
          <div class="form-group" style="margin-bottom: 0">
            <label class="form-label">Max Price</label>
            <input
              type="number"
              class="form-control"
              id="maxPrice"
              placeholder="1000"
            />
          </div>
        </div>
      </section>

      <!-- Products Header -->
      <div class="products-header">
        <p class="product-count">
          <span id="productCount">0</span> products found
        </p>
        <p>
          <i class="fa-solid fa-heart"></i> Wishlist:
          <span id="wishlistCount">0</span>
        </p>
      </div>

      <!-- Products Grid -->
      <div class="products-grid" id="productsGrid">
        <p class="text-center text-muted">Loading products...</p>
      </div>
    </main>

    <!-- Floating Cart Button -->
    <a href="cart.html" class="cart-icon">
      <i class="fa-solid fa-cart-shopping"></i>
      <span class="cart-badge" id="cartBadge">0</span>
    </a>

    <!-- Firebase SDK -->
    <!-- Firebase SDK -->
    <script src="../shared/env.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="products.js"></script>
    <script>
      // Update cart badge
      function updateCartBadge() {
        var cart = JSON.parse(localStorage.getItem("cart")) || [];
        var count = 0;
        for (var i = 0; i < cart.length; i++) {
          count += cart[i].quantity;
        }
        document.getElementById("cartBadge").textContent = count;
      }
      updateCartBadge();
    </script>
  </body>
</html>
